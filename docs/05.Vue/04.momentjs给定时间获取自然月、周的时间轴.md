---
title: moment.jsç»™å®šæ—¶é—´èŽ·å–è‡ªç„¶æœˆã€å‘¨çš„æ—¶é—´è½´
date: 2021-11-12 16:48:15
permalink: /pages/9d3f73/
categories:
  - Vue
tags:
  -
---

### 1.éœ€æ±‚

![è¯·æ·»åŠ å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/99fb7ed0448c4ab48925cd2c789c5af1~tplv-k3u1fbpfcp-zoom-1.image)
è¦å®žçŽ°è¿™ä¸ªæ—¶é—´è½´çš„è‡ªç„¶å‘¨ã€è‡ªç„¶æœˆçš„é€‰æ‹©åŠŸèƒ½ï¼Œéœ€è¦æ€è€ƒä¸¤ä¸ªé—®é¢˜

1. å¤„ç†ç»™å®šæ—¶é—´çš„æœ¬å‘¨ä¸Žæœ¬æœˆæ—¶é—´çš„æ˜¾ç¤ºï¼Œå¦‚è¾“å…¥ 2021-07-29ï¼Œæœ€åŽä¸€ä¸ªæœˆå°±æ˜¯ 2021-07-01 -
   2021-07-29ï¼Œæœ€åŽä¸€å‘¨å°±æ˜¯ 2021-07-26 - 2021-07-29
2. èŽ·å–å¾€å‰çš„è‡ªç„¶æœˆå’Œå‘¨çš„ç¬¬ä¸€å¤©å’Œæœ€åŽä¸€å¤©ï¼ˆæ¯å‘¨å›ºå®šä¸ƒå¤©å¥½å¤„ç†ï¼Œæ¯æœˆçš„å¤©æ•°ä¸ç¡®å®šï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼‰

### 2.ç»™å®šæ—¶é—´ èŽ·å–è‡ªç„¶æœˆã€å‘¨çš„æ—¶é—´èŒƒå›´

å¤„ç†å‘¨å‚æ•°æ€è·¯

> moment().weekday(0) è®¾ç½®æ—¥æœŸä¸ºå½“å‰æ—¶åŒºå‘¨ä¸€
> moment().weekday(6) è®¾ç½®æ—¥æœŸä¸ºå½“å‰æ—¶åŒºå‘¨æ—¥
>
> å¤„ç†æœˆå‚æ•°æ€è·¯
> å½“å‰æœˆçš„æœ€åŽä¸€å¤©çš„æ—¶é—´æˆ³ç­‰äºŽä¸Šä¸ªæœˆçš„æœ€åŽä¸€å¤© + 24 _ 3600
> const day1Unix = moment().date(1)).unix() // èŽ·å–å½“æœˆ 1 å·æ—¥æœŸæ—¶é—´æˆ³
> const dayLast = moment.unix(day1Unix - 24 _ 3600) // èŽ·å¾—ä¸Šä¸ªæœˆæœ€åŽä¸€å¤©æ—¥æœŸ

æ ¹æ®ä¸Šé¢çš„æ€è·¯

### 3.èŽ·å–æ—¶é—´è½´ list

```js
// å¯¼å…¥moment å¹¶è®¾ç½®æ—¶é—´åŒºåŸŸä¸ºä¸­å›½
import moment from 'moment'
moment.locale('zh-cn')
/**
 * æ ¹æ®æ—¶é—´åˆ»åº¦ day week month ç”Ÿæˆå¯¹åº”çš„æ—¶é—´æ®µåˆ—è¡¨
 * step: æ—¶é—´æ®µåˆ»åº¦ day | week | month
 * num: è¾“å‡ºå¤šå°‘ç»„æ•°æ®
 * displayTimeFormat: æ˜¾ç¤ºæ—¶é—´çš„æ ¼å¼(å¯è‡ªå®šä¹‰)
 * rangeTimeFormat: æ—¶é—´èŒƒå›´çš„æ ¼å¼(å¯è‡ªå®šä¹‰)
 */
export const getRangeTimeList = function(
  step,
  num = 50,
  displayTimeFormat = 'YYYYå¹´MMæœˆDDæ—¥',
  rangeTimeFormat = 'YYYY-MM-DD'
) {
  let now = moment() // å½“å‰æ—¥æœŸ
  let result: any[] = []
  const oneDayTime = 24 * 3600 // ä¸€å¤©çš„ç§’æ•° æ³¨æ„ä¸æ˜¯æ¯«ç§’æ•°
  let currentUnix = now.unix() // å½“å‰unixæ—¶é—´æˆ³

  const getTimeRange = (begin, end) => {
    return [begin.format(rangeTimeFormat), end.format(rangeTimeFormat)]
  }
  const getDisplayTime = (begin, end) => {
    return begin.format(displayTimeFormat) + '-' + end.format(displayTimeFormat)
  }

  if (step === 'day') {
    for (let k = 1; k <= num; k++) {
      const obj: any = {}
      const day = moment.unix(currentUnix)
      obj.timeRange = getTimeRange(day, day)
      obj.tooltip = getDisplayTime(day, day)
      result.push(obj)
      currentUnix -= oneDayTime
    }
  }
  if (step === 'week') {
    // å¤„ç†å½“å‰è¿™å‘¨
    const lastWeek: any = {}
    const firstDay = moment(now).weekday(0)
    lastWeek.timeRange = getTimeRange(firstDay, now)
    lastWeek.tooltip = getDisplayTime(firstDay, now)
    currentUnix = firstDay.unix()
    result.push(lastWeek)
    // å¤„ç†å‰©ä½™n-1å‘¨
    for (let k = 2; k <= num; k++) {
      const obj: any = {}
      const sunday = moment.unix(currentUnix - oneDayTime) // å½“å‰å‘¨-æ—¶é—´æˆ³å‡åŽ»ä¸€å¤© ç­‰äºŽä¸Šå‘¨æ—¥æ—¶é—´æˆ³
      const monday = moment(moment.unix(currentUnix - oneDayTime).weekday(0))
      obj.timeRange = getTimeRange(monday, sunday)
      obj.tooltip = getDisplayTime(monday, sunday)
      result.push(obj)
      currentUnix -= oneDayTime * 7
    }
  }
  if (step === 'month') {
    // å¤„ç†å½“å‰æœˆ
    const lastMonth: any = {}
    const firstDate = moment(now).date(1)
    lastMonth.timeRange = getTimeRange(firstDate, now)
    lastMonth.tooltip = getDisplayTime(firstDate, now)
    currentUnix = firstDate.unix()
    result.push(lastMonth)
    // å¤„ç†å‰©ä½™n-1ä¸ªæœˆ
    for (let k = 2; k <= num; k++) {
      const obj: any = {}
      const dayLast = moment.unix(currentUnix - oneDayTime) // å½“å‰æœˆç¬¬ä¸€å¤©æ—¶é—´æˆ³å‡åŽ»ä¸€å¤© ç­‰äºŽä¸Šä¸ªæœˆæœ€åŽä¸€å¤©æ—¶é—´æˆ³
      const n = dayLast.date()
      const day1 = moment(moment.unix(currentUnix - oneDayTime).date(1))
      obj.timeRange = getTimeRange(day1, dayLast)
      obj.tooltip = getDisplayTime(day1, dayLast)
      result.push(obj)
      currentUnix -= oneDayTime * n
    }
  }
  return result
}
```

æµ‹è¯•ä¸€ä¸‹
```js
const day = getRangeTimeList('day')
const week = getRangeTimeList('week')
const month = getRangeTimeList('month')
console.log('ðŸš€ ~ day', day)
console.log('ðŸš€ ~ week', week)
console.log('ðŸš€ ~ month', month)
```
å¾—åˆ°
![day](https://raw.gitmirror.com/GanChuanYin/picture/main/blog/20211123150317.png)

![week](https://raw.gitmirror.com/GanChuanYin/picture/main/blog/20211123150411.png)

![month](https://raw.gitmirror.com/GanChuanYin/picture/main/blog/20211123150509.png)
