---
title: computed和watch有何区别
date: 2021-11-29 22:06:19
permalink: /pages/e75e3a/
categories:
  - 前端
tags:
  -
---

## computed和watch有何区别？

### 一、computed

> 在 Vue 的 template 模板内是可以写一些简单的 js 表达式的很便利，如上直接计算 this.firstName + ' ' + this.lastName，因为在模版中放入太多声明式的逻辑会让模板本身过重，尤其当在页面中使用大量复杂的逻辑表达式处理数据时，会对页面的可维护性造成很大的影响，而 computed 的设计初衷也正是用于解决此类问题。

**特点：**

1. computed 具有`缓存机制`，依赖值不变的情况下其会直接读取缓存进行复用

2. computed 是依赖已有的变量来计算一个目标变量，大多数情况都是多个变量凑在一起计算出一个变量

3. computed 不能进行异步操作

> Ps: 计算属性内的值须是响应式数据才能触发重新计算。

### 二、watch

> watcher 更像是一个 data 的数据监听回调，当依赖的 data 的数据变化，执行回调，在方法中会传入 newVal 和 oldVal。可以提供输入值无效，提供中间值 特场景。Vue 实例将会在实例化时调用 \$watch()，遍历 watch 对象的每一个属性。如果你需要在某个数据变化时做一些事情，使用 watch。

**特点：**

1. watch 是监听某一个变量的变化，并执行相应的回调函数，通常是一个变量的变化决定多个变量的变化
2. watch 可以进行异步操作

watch 的原理就是为需要观察的数据创建并收集`user-watcher`

当数据改变时通知到`user-watcher`将新值和旧值传递给用户自己定义的回调函数

**参数：**

```js
 personInfo = {
   name:'lili',
   age:12,
   Hobbies:['singing', 'dance']
 }

@Watch('personInfo', { immediate: true, deep: true })
  onPersonInfoChange(newValue,oldValue) {
    code...
  }
```

以上参数的含义是初始化立即执行一次 onPersonInfoChange 函数，在 personInfo 里的任何字段变化时，执行 onPersonInfoChange

**immediate、deep 实现原理是：**

immediate 初始化时立即执行一次回调函数

deep 是递归的对它的子值进行依赖收集，任何依赖发生变化就执行回调

### 三、总结

简单记就是：一般情况下**computed 是多对一，watch 是一对多**

### 四、应用场景

**computed：**

场景：模板中的某个值需要通过一个或多个数据计算得到并且不用重复数据计算

重点`计算得到的新值`**

**watch：**

场景：监听属性主要是监听某个值发生变化后，对新值去进行逻辑处理。

重点： `某一个特定值发生了变化，需要根据它的变化做一些事情`

​
