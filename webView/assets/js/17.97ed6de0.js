(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{433:function(s,t,a){"use strict";a.r(t);var n=a(15),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"跨域问题总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#跨域问题总结"}},[s._v("#")]),s._v(" 跨域问题总结")]),s._v(" "),a("h2",{attrs:{id:"为什么会有跨域这个问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么会有跨域这个问题"}},[s._v("#")]),s._v(" 为什么会有跨域这个问题？")]),s._v(" "),a("blockquote",[a("p",[s._v("原因是浏览器为了安全，而采用的同源策略（Same origin policy）")])]),s._v(" "),a("h2",{attrs:{id:"什么是同源策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是同源策略"}},[s._v("#")]),s._v(" 什么是同源策略？")]),s._v(" "),a("ol",[a("li",[s._v("同源策略是由 Netscape 提出的一个著名的安全策略，现在所有支持 JavaScript 的浏览器都会使用这个策略。")]),s._v(" "),a("li",[s._v("Web 是构建在同源策略基础之上的，浏览器只是针对同源策略的一种实现")]),s._v(" "),a("li",[s._v("所谓同源是指：协议、域名、端口必须要完全相同。即：协议、域名、端口都相同，才能算是在同一个域里面")])]),s._v(" "),a("h2",{attrs:{id:"非同源受到哪些限制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#非同源受到哪些限制"}},[s._v("#")]),s._v(" 非同源受到哪些限制？")]),s._v(" "),a("ol",[a("li",[s._v("cookie 不能读取")]),s._v(" "),a("li",[s._v("DOM 无法获得")]),s._v(" "),a("li",[s._v("Ajax 请求不能发送")])]),s._v(" "),a("h2",{attrs:{id:"如何在开发中解决跨域问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何在开发中解决跨域问题"}},[s._v("#")]),s._v(" 如何在开发中解决跨域问题")]),s._v(" "),a("h3",{attrs:{id:"jsonp-解决跨域发送请求跨域问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jsonp-解决跨域发送请求跨域问题"}},[s._v("#")]),s._v(" jsonp 解决跨域发送请求跨域问题")]),s._v(" "),a("blockquote",[a("p",[s._v("要明确的是：jsonp 不是一种技术，而是程序员“智慧的结晶”（利用了标签请求资源不受同源策略限制的特点）"),a("br"),s._v("\njsonp 需要前后端人员互相配合")])]),s._v(" "),a("h4",{attrs:{id:"jsonp-是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jsonp-是什么"}},[s._v("#")]),s._v(" jsonp 是什么？")]),s._v(" "),a("p",[s._v("jsonp（JSON with Padding），是一个非官方的跨域解决方案，纯粹凭借程序员的聪明才智开发出来，只支持 get 请求。")]),s._v(" "),a("h4",{attrs:{id:"jsonp-怎么工作的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jsonp-怎么工作的"}},[s._v("#")]),s._v(" jsonp 怎么工作的？")]),s._v(" "),a("ol",[a("li",[s._v("网页中有一些标签天生具有跨域的能力，比如：img、link、iframe、script。")]),s._v(" "),a("li",[s._v("jsonp 就是利用 script 标签的跨域能力来发送请求的。")])]),s._v(" "),a("h4",{attrs:{id:"jsonp-的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jsonp-的使用"}},[s._v("#")]),s._v(" jsonp 的使用")]),s._v(" "),a("blockquote",[a("p",[s._v("创建 script 节点，指定 src，利用标签把请求发出去"),a("br"),s._v("\n定义好一个处理数据的函数"),a("br"),s._v("\n把数据处理函数的名称传递个后端"),a("br"),s._v("\n后端返回符合 js 函数调用语法的字符串")])]),s._v(" "),a("ol",[a("li",[s._v("动态的创建一个 script 标签")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" script "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'script'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("添加请求路径和请求参数")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'url?callback=getData'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("定义一个全局函数")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("getData")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("把标签放入页面")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("script"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("5.后端配合")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 后端获取到参数，查询数据库，获得所需数据")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 给请求发送响应，因为script会对请求到的数据，进行js运行，所以如果返回回来的数据中有js代码的话，会执行js代码")]),s._v("\nresponse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("callback"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),s._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("stringify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"局限性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#局限性"}},[s._v("#")]),s._v(" 局限性")]),s._v(" "),a("ol",[a("li",[s._v("只能解决 GET 请求跨域问题")]),s._v(" "),a("li",[s._v("必须需要后端人员配合")])]),s._v(" "),a("h3",{attrs:{id:"cors-解决跨域"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cors-解决跨域"}},[s._v("#")]),s._v(" cors 解决跨域")]),s._v(" "),a("h4",{attrs:{id:"node-后端设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-后端设置"}},[s._v("#")]),s._v(" node 后端设置")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Access-Control-Allow-Origin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:8080'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nresponse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Access-Control-Allow-Methods'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GET,PUT,POST,DELETE'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nresponse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Access-Control-Allow-Headers'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);