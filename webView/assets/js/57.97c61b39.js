(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{474:function(s,t,a){"use strict";a.r(t);var n=a(15),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"serverless"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#serverless"}},[s._v("#")]),s._v(" Serverless")]),s._v(" "),a("p",[s._v("持续完善")]),s._v(" "),a("blockquote",[a("p",[s._v("参考：https://blog.csdn.net/CharlesYooSky/article/details/103021510")])]),s._v(" "),a("ul",[a("li",[s._v("按量付费")]),s._v(" "),a("li",[s._v("弹性伸缩")]),s._v(" "),a("li",[s._v("无需运维")]),s._v(" "),a("li",[s._v("开发简单")]),s._v(" "),a("li",[s._v("降低风险")]),s._v(" "),a("li",[s._v("易于扩展")])]),s._v(" "),a("p",[s._v("历史：物理机时代 -> 虚拟机时代 -> 容器时代 -> Serverless 时代")]),s._v(" "),a("h2",{attrs:{id:"iaas、paas、saas、faas、baas"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#iaas、paas、saas、faas、baas"}},[s._v("#")]),s._v(" IaaS、PaaS、SaaS、FaaS、BaaS")]),s._v(" "),a("h3",{attrs:{id:"iaas"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#iaas"}},[s._v("#")]),s._v(" IaaS")]),s._v(" "),a("p",[s._v("Infrastructure as a Service(基础设施即服务)")]),s._v(" "),a("h3",{attrs:{id:"paas"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#paas"}},[s._v("#")]),s._v(" PaaS")]),s._v(" "),a("p",[s._v("Platform as a Service（平台即服务）")]),s._v(" "),a("h3",{attrs:{id:"saas"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#saas"}},[s._v("#")]),s._v(" SaaS")]),s._v(" "),a("p",[s._v("Software as a Service（软件即服务）")]),s._v(" "),a("h3",{attrs:{id:"faas"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#faas"}},[s._v("#")]),s._v(" FaaS")]),s._v(" "),a("p",[s._v("Function as a service（函数即服务）")]),s._v(" "),a("h3",{attrs:{id:"baas"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#baas"}},[s._v("#")]),s._v(" BaaS")]),s._v(" "),a("p",[s._v("Backend as a Service（后端即服务）")]),s._v(" "),a("h2",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://help.aliyun.com/document_detail/51733.html?spm=5176.137990.J_709424.4.15fb6320LjmjkS",target:"_blank",rel:"noopener noreferrer"}},[s._v("参看"),a("OutboundLink")],1)])]),s._v(" "),a("ul",[a("li",[s._v("Serverless 的应用基本组成单位是函数，函数之间相互独立，因此 Serverless 能提高应用稳定性")]),s._v(" "),a("li",[s._v("广义的 Serverless 是构建和运行软件时不需要关心服务器的一种架构思想")]),s._v(" "),a("li",[s._v("狭义的 Serverless 是 FaaS 和 BaaS 的组合")])]),s._v(" "),a("img",{attrs:{src:"http://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/assets/pic/51733/cn_zh/1508847941316/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0%E8%AE%A1%E7%AE%97.png",alt:"函数计算图片"}}),s._v(" "),a("p",[s._v("① 开发者编写代码")]),s._v(" "),a("p",[s._v("② 把代码上传到函数计算上，上传的方式有通过 API 或者 SDK 上传，也可以通过控制台页面上传")]),s._v(" "),a("p",[s._v("③ 通过 API&SDK 来触发函数计算执行，同样也可以通过云产品的事件源来触发函数计算执行。")]),s._v(" "),a("p",[s._v("④ 函数计算在执行过程中，会根据用户请求量动态扩容函数计算来保证请求峰值的执行，这个过程对用户是透明无感知的。")]),s._v(" "),a("p",[s._v("⑤ 函数执行结束后，可以通过账单来查看执行费用，根据函数的实际执行时间按量计费。")]),s._v(" "),a("h2",{attrs:{id:"优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化"}},[s._v("#")]),s._v(" 优化")]),s._v(" "),a("blockquote",[a("p",[s._v("核心就是减少冷启动")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[s._v("下载代码")]),s._v(" "),a("th",{staticStyle:{"text-align":"center"}},[s._v("启动运行环境")]),s._v(" "),a("th",{staticStyle:{"text-align":"center"}},[s._v("执行初始化代码")]),s._v(" "),a("th",{staticStyle:{"text-align":"center"}},[s._v("执行入口函数")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("完全冷启动")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("完全冷启动")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("部分冷启动")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("热启动")])])])]),s._v(" "),a("p",[s._v("函数第一次执行的时候一定是冷启动"),a("br"),s._v("\n但后面的请求不一定都是热启动"),a("br"),s._v("\n这与触发函数执行的事件是串行还是并行有关")]),s._v(" "),a("ol",[a("li",[s._v("避免函数冷启动\n"),a("ul",[a("li",[s._v("对函数进行预热：在真实请求到来之前对函数发起请求，是函数提前初始化")]),s._v(" "),a("li",[s._v("使用预留资源")])])]),s._v(" "),a("li",[s._v("减小代码体积\n"),a("ul",[a("li",[s._v("避免引入不必要的依赖")]),s._v(" "),a("li",[s._v("不要加载不需要的代码")]),s._v(" "),a("li",[s._v("对 SDK 进行精简")]),s._v(" "),a("li",[s._v("对代码进行压缩")])])]),s._v(" "),a("li",[s._v("提升函数吞吐量")]),s._v(" "),a("li",[s._v("选择合适的编程语言")])]),s._v(" "),a("h2",{attrs:{id:"使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),a("blockquote",[a("p",[s._v("以阿里云函数计算为例")])]),s._v(" "),a("ul",[a("li",[s._v("开通功能："),a("a",{attrs:{href:"https://www.aliyun.com/product/fc?spm=5176.cnfnf.J_8058803260.121.2e291ea8S1XE81",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.aliyun.com/product/fc?spm=5176.cnfnf.J_8058803260.121.2e291ea8S1XE81"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("创建函数：\n"),a("ul",[a("li",[s._v("以 http 函数为例")]),s._v(" "),a("li",[s._v("入口："),a("code",[s._v("index.exports.handler")])]),s._v(" "),a("li",[s._v("执行请求： "),a("code",[s._v("curl https://xxxxxxxxxx.cn-hangzhou.fc.aliyuncs.com/2016-08-15/proxy/helloworld/sayhello/")])])])])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" getRawBody "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'raw-body'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" getFormBody "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'body/form'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" body "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'body'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\nTo enable the initializer feature (https://help.aliyun.com/document_detail/156876.html)\nplease implement the initializer function as below：\nexports.initializer = (context, callback) => {\n  console.log('initializing');\n  callback(null, '');\n};\n*/")]),s._v("\n\nexports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("handler")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" resp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" context")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello world'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" params "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    queries"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("queries"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    method"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    requestURI"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    clientIP"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("clientIP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRawBody")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("queries"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("queries"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      resp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    resp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("stringify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'    '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\n    getFormBody(req, function(err, formBody) {\n        for (var key in req.queries) {\n          var value = req.queries[key];\n          resp.setHeader(key, value);\n        }\n        params.body = formBody;\n        console.log(formBody);\n        resp.send(JSON.stringify(params));\n    }); \n    */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br")])]),a("img",{attrs:{src:"https://raw.githubusercontent.com/coderlyu/au-blog/master/docs/.vuepress/public/images/blogs/serverless-1.png",alt:"serlverless执行图片"}}),s._v(" "),a("p",[a("strong",[s._v("注意")]),s._v("：http 函数服务，不要用浏览器直接去请求，虽然也是发起 get 请求，但是会被浏览器当成附件下载")]),s._v(" "),a("h2",{attrs:{id:"优化应用成本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化应用成本"}},[s._v("#")]),s._v(" 优化应用成本")]),s._v(" "),a("ol",[a("li",[s._v("提升函数性能\n"),a("ul",[a("li",[s._v("serverless 应用是按执行次数和执行时消耗的内存等资源计费，函数性能越高，执行时间越短，成本越低")])])]),s._v(" "),a("li",[s._v("为函数设置超时时间\n"),a("ul",[a("li",[s._v("为了避免函数因异常而无限运行")])])]),s._v(" "),a("li",[s._v("选择合适的云服务")]),s._v(" "),a("li",[s._v("选择合适的计费方式\n"),a("ul",[a("li",[s._v("按量付费和预付费")])])]),s._v(" "),a("li",[s._v("关注 Fass 和 Bass 等云服务的总成本")])])])}),[],!1,null,null,null);t.default=e.exports}}]);